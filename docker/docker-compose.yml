services:
  genjax:
    build:
      context: ..
      dockerfile: docker/genjax/Dockerfile
    image: crosscat-genjax:latest
    environment:
      - JAX_PLATFORM_NAME=cpu
    volumes:
      - ..:/workspaces/crosscat:cached
      - genjax-uv-cache:/root/.cache/uv
    working_dir: /workspaces/crosscat
    command: ["bash"]

  legacy:
    build:
      context: ..
      dockerfile: docker/legacy/Dockerfile
    image: crosscat-legacy:latest
    volumes:
      - ..:/workspaces/crosscat:cached
    working_dir: /workspaces/crosscat
    command: ["bash"]

volumes:
  genjax-uv-cache:
